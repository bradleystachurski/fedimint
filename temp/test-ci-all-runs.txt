test run 1
./scripts/tests/test-ci-all.sh
Pre-building workspace...
    Finished dev [unoptimized + debuginfo] target(s) in 0.24s
Pre-building tests...
    Finished test [unoptimized + debuginfo] target(s) in 0.22s
## Starting all tests in parallel...
## START: always_success_test
## COMPLETE: always_success_test
## START: lightning_reconnect_test
00:00:00 Setting up env variables in /tmp/nix-shell.mCrVBQ/nix-shell.bWG9jl/fm-Qd2S
00:00:00     Finished dev [unoptimized + debuginfo] target(s) in 0.28s
00:00:00 2023-09-24T05:36:49.696165Z  INFO devimint: Test setup in "/tmp/nix-shell.mCrVBQ/nix-shell.bWG9jl/fm-Qd2S/cfg"
00:00:00 2023-09-24T05:36:49.697660Z  WARN devimint: Failed to create wallet ... retrying JSON-RPC error: transport error: Couldn't connect to host: Connection refused (os error 111)
00:00:03 2023-09-24T05:36:52.667436Z  INFO devimint: electrs started
00:00:03 2023-09-24T05:36:52.668542Z  INFO devimint: esplora started
00:00:03 2023-09-24T05:36:52.668602Z  INFO devimint::federation: fedimintd-0 started
00:00:03 2023-09-24T05:36:52.676569Z  INFO devimint::federation: fedimintd-3 started
00:00:03 2023-09-24T05:36:52.678208Z  INFO devimint::federation: fedimintd-1 started
00:00:03 2023-09-24T05:36:52.684562Z  INFO devimint::federation: fedimintd-2 started
00:00:03 2023-09-24T05:36:52.698338Z  WARN net::api: Unable to connect to peer peer_id=0 err=Networking or low-level protocol error: Error when opening the TCP socket: Connection refused (os error 111)
00:00:04 2023-09-24T05:36:53.703076Z  INFO devimint::federation: Connected to 0
00:00:04 2023-09-24T05:36:53.704888Z  INFO devimint::federation: Connected to 1
00:00:04 2023-09-24T05:36:53.706497Z  INFO devimint::federation: Connected to 2
00:00:04 2023-09-24T05:36:53.708007Z  INFO devimint::federation: Connected to 3
00:00:04 2023-09-24T05:36:53.716237Z  INFO devimint::federation: calling set_config_gen_connections for 1 random-y4eH91
00:00:04 2023-09-24T05:36:53.723890Z  INFO devimint::federation: calling set_config_gen_connections for 2 random-jHj7B2
00:00:04 2023-09-24T05:36:53.731178Z  INFO devimint::federation: calling set_config_gen_connections for 3 random-EegPP3
00:00:04 2023-09-24T05:36:53.758890Z  INFO devimint::federation: Running DKG...
00:00:06 2023-09-24T05:36:55.798559Z  INFO devimint::federation: DKG successfully complete. Starting consensus...
00:00:06 2023-09-24T05:36:55.804975Z ERROR jsonrpsee_core::client::async_client: [backend]: Networking or low-level protocol error: WebSocket connection error: connection closed
00:00:06 2023-09-24T05:36:55.805252Z  INFO devimint::federation: Error calling start_consensus: FederationError { general: Some(Received errors from 1 peers: peer-0: Rpc error: The background task been terminated because: Networking or low-level protocol error: WebSocket connection error: connection closed; restart required), peers: {PeerId(0): Rpc(RestartNeeded("Networking or low-level protocol error: WebSocket connection error: connection closed"))} }, trying to continue...
00:00:06 2023-09-24T05:36:55.805516Z  WARN net::api: Unable to connect to peer peer_id=0 err=Networking or low-level protocol error: Error when opening the TCP socket: Connection refused (os error 111)
00:00:07 2023-09-24T05:36:56.825155Z ERROR jsonrpsee_core::client::async_client: [backend]: Networking or low-level protocol error: WebSocket connection error: connection closed
00:00:07 2023-09-24T05:36:56.825553Z  INFO devimint::federation: Error calling start_consensus: FederationError { general: Some(Received errors from 1 peers: peer-0: Rpc error: The background task been terminated because: Networking or low-level protocol error: WebSocket connection error: connection closed; restart required), peers: {PeerId(0): Rpc(RestartNeeded("Networking or low-level protocol error: WebSocket connection error: connection closed"))} }, trying to continue...
00:00:07 2023-09-24T05:36:56.825939Z  WARN net::api: Unable to connect to peer peer_id=0 err=Networking or low-level protocol error: Error when opening the TCP socket: Connection refused (os error 111)
00:00:08 2023-09-24T05:36:57.148618Z  INFO devimint: lightning started
00:00:08 2023-09-24T05:36:57.185798Z  INFO devimint: block sync done
00:00:08 2023-09-24T05:36:57.216204Z  INFO devimint: Sending funds from bitcoind amount=100000000 addr="bcrt1qpd4z759nlkhyw5uy9kp99gc5jglw5zchrxkynd"
00:00:08 2023-09-24T05:36:57.278793Z  INFO devimint: Mining bitcoin blocks block_num=10
00:00:08 2023-09-24T05:36:57.790495Z  INFO devimint: Mining bitcoin blocks block_num=10
00:00:08 2023-09-24T05:36:57.978196Z ERROR jsonrpsee_core::client::async_client: [backend]: Networking or low-level protocol error: WebSocket connection error: connection closed
00:00:08 2023-09-24T05:36:57.978448Z  INFO devimint::federation: Error calling start_consensus: FederationError { general: Some(Received errors from 1 peers: peer-0: Rpc error: The background task been terminated because: Networking or low-level protocol error: WebSocket connection error: connection closed; restart required), peers: {PeerId(0): Rpc(RestartNeeded("Networking or low-level protocol error: WebSocket connection error: connection closed"))} }, trying to continue...
00:00:08 2023-09-24T05:36:57.979208Z  WARN net::api: Unable to connect to peer peer_id=0 err=Networking or low-level protocol error: Error when opening the TCP socket: Connection refused (os error 111)
00:00:09 2023-09-24T05:36:58.992919Z ERROR jsonrpsee_core::client::async_client: [backend]: Networking or low-level protocol error: WebSocket connection error: connection closed
00:00:09 2023-09-24T05:36:58.993190Z  INFO devimint::federation: Error calling start_consensus: FederationError { general: Some(Received errors from 1 peers: peer-0: Rpc error: The background task been terminated because: Networking or low-level protocol error: WebSocket connection error: connection closed; restart required), peers: {PeerId(0): Rpc(RestartNeeded("Networking or low-level protocol error: WebSocket connection error: connection closed"))} }, trying to continue...
00:00:09 2023-09-24T05:36:58.993453Z  WARN net::api: Unable to connect to peer peer_id=0 err=Networking or low-level protocol error: Error when opening the TCP socket: Connection refused (os error 111)
00:00:10 2023-09-24T05:36:59.191888Z  INFO devimint: gateways started
00:00:10 2023-09-24T05:36:59.997722Z  INFO devimint::federation: Consensus is running
00:00:10 2023-09-24T05:36:59.998060Z  INFO devimint::federation: copied client configs
00:00:10 2023-09-24T05:36:59.998092Z  INFO devimint: federation and gateways started
00:00:10 2023-09-24T05:36:59.998771Z  INFO devimint: Joining federation with the main client
00:00:13 2023-09-24T05:37:02.540162Z  INFO devimint: Generating first epoch
00:00:13 2023-09-24T05:37:02.579688Z  INFO devimint: Mining bitcoin blocks block_num=10
00:00:14 2023-09-24T05:37:03.182049Z  INFO devimint: await gateways registered
00:00:14 2023-09-24T05:37:03.364319Z  INFO devimint: gateways registered
00:00:14 2023-09-24T05:37:03.603595Z  INFO devimint::federation: Using cln gateway
00:00:14 2023-09-24T05:37:03.603645Z  INFO devimint: starting dev federation took 13.907331243s
00:00:14 2023-09-24T05:37:03.603682Z  INFO devimint: Pegging-in both gateways
00:00:14 2023-09-24T05:37:03.603705Z  INFO devimint::federation: Pegging-in gateway funds amount=99999
00:00:14 2023-09-24T05:37:03.651515Z  INFO devimint: Sending funds from bitcoind amount=99999 addr="bcrt1qzp9r24sghu8ugxsccyfwtwep4fewc6yzs8ffyqag9vta952ta6uqh6d0gp"
00:00:14 2023-09-24T05:37:03.676581Z  INFO devimint: Mining bitcoin blocks block_num=21
00:00:26 2023-09-24T05:37:15.958258Z  INFO devimint::federation: Pegging-in gateway funds amount=99999
00:00:26 2023-09-24T05:37:15.997557Z  INFO devimint: Sending funds from bitcoind amount=99999 addr="bcrt1q0eld37paap7r2ceh3z39netrmf3qd6e9ggzgt6vnac9208d5eursqnqldu"
00:00:27 2023-09-24T05:37:16.033518Z  INFO devimint: Mining bitcoin blocks block_num=21
00:00:33 2023-09-24T05:37:22.745711Z  INFO devimint: Stopping all lightning nodes
00:00:33 2023-09-24T05:37:22.828727Z  INFO devimint: Stopping lightning node
00:00:33 2023-09-24T05:37:22.833457Z  INFO devimint: sending SIGTERM to lightningd and waiting for it to exit
00:00:33 2023-09-24T05:37:22.911325Z  INFO devimint: Stopping lightning node
00:00:33 2023-09-24T05:37:22.911380Z  INFO devimint: sending SIGTERM to lnd and waiting for it to exit
00:00:33 2023-09-24T05:37:22.966694Z  INFO devimint: Restarting both lightning nodes...
00:00:34 2023-09-24T05:37:23.383637Z  INFO devimint::external: lnd_connect failed: ConnectError { internal: Connect { address: "http://localhost:11009", error: tonic::transport::Error(Transport, hyper::Error(Connect, ConnectError("tcp connect error", Os { code: 111, kind: ConnectionRefused, message: "Connection refused" }))) } }
00:00:34 2023-09-24T05:37:23.395376Z  INFO devimint::external: lnd_connect failed: ConnectError { internal: Connect { address: "http://localhost:11009", error: tonic::transport::Error(Transport, hyper::Error(Connect, ConnectError("tcp connect error", Os { code: 111, kind: ConnectionRefused, message: "Connection refused" }))) } }
00:00:36 2023-09-24T05:37:25.021468Z  INFO devimint: Retrying info...
00:00:40 2023-09-24T05:37:29.361411Z  INFO devimint::federation: Using cln gateway
00:00:40 2023-09-24T05:37:29.361464Z  INFO devimint: Creating invoice....
00:00:44 2023-09-24T05:37:33.250658Z  INFO devimint: sending SIGKILL to gatewayd-cln and waiting for it to exit
00:00:44 2023-09-24T05:37:33.779488Z  INFO devimint::federation: Using lnd gateway
00:00:44 2023-09-24T05:37:33.779630Z  INFO devimint: Creating invoice....
00:00:49 2023-09-24T05:37:38.392706Z  INFO devimint: sending SIGKILL to gatewayd-lnd and waiting for it to exit
00:00:49 2023-09-24T05:37:38.400555Z  INFO devimint: lightning_reconnect_test: success
00:00:49 2023-09-24T05:37:38.400627Z  INFO devimint: sending SIGKILL to lnd and waiting for it to exit
00:00:49 2023-09-24T05:37:38.409638Z  INFO devimint: sending SIGTERM to lightningd and waiting for it to exit
00:00:49 2023-09-24T05:37:38.412299Z  INFO devimint: sending SIGKILL to faucet and waiting for it to exit
00:00:49 2023-09-24T05:37:38.413580Z  INFO devimint: sending SIGKILL to esplora and waiting for it to exit
00:00:49 2023-09-24T05:37:38.417223Z  INFO devimint: sending SIGKILL to electrs and waiting for it to exit
00:00:49 2023-09-24T05:37:38.421006Z  INFO devimint: sending SIGKILL to fedimintd-0 and waiting for it to exit
00:00:49 2023-09-24T05:37:38.435854Z  INFO devimint: sending SIGKILL to fedimintd-1 and waiting for it to exit
00:00:49 2023-09-24T05:37:38.447835Z  INFO devimint: sending SIGKILL to fedimintd-2 and waiting for it to exit
00:00:49 2023-09-24T05:37:38.456370Z  INFO devimint: sending SIGKILL to fedimintd-3 and waiting for it to exit
00:00:49 2023-09-24T05:37:38.468172Z  INFO devimint: sending SIGKILL to bitcoind and waiting for it to exit
## COMPLETE: lightning_reconnect_test
## START: gateway_reboot_test
00:00:00 Setting up env variables in /tmp/nix-shell.mCrVBQ/nix-shell.bWG9jl/fm-rig4
00:00:01     Finished dev [unoptimized + debuginfo] target(s) in 0.59s
00:00:01 2023-09-24T05:36:55.375475Z  INFO devimint: Test setup in "/tmp/nix-shell.mCrVBQ/nix-shell.bWG9jl/fm-rig4/cfg"
00:00:01 2023-09-24T05:36:55.376651Z  WARN devimint: Failed to create wallet ... retrying JSON-RPC error: transport error: Couldn't connect to host: Connection refused (os error 111)
00:00:05 2023-09-24T05:36:59.531473Z  INFO devimint: electrs started
00:00:05 2023-09-24T05:36:59.536137Z  INFO devimint: esplora started
00:00:05 2023-09-24T05:36:59.536227Z  INFO devimint::federation: fedimintd-0 started
00:00:05 2023-09-24T05:36:59.541510Z  INFO devimint::federation: fedimintd-1 started
00:00:05 2023-09-24T05:36:59.542245Z  INFO devimint::federation: fedimintd-2 started
00:00:05 2023-09-24T05:36:59.543142Z  INFO devimint::federation: fedimintd-3 started
00:00:05 2023-09-24T05:36:59.546137Z  WARN net::api: Unable to connect to peer peer_id=0 err=Networking or low-level protocol error: Error when opening the TCP socket: Connection refused (os error 111)
00:00:06 2023-09-24T05:37:00.549784Z  INFO devimint::federation: Connected to 0
00:00:06 2023-09-24T05:37:00.551522Z  INFO devimint::federation: Connected to 1
00:00:06 2023-09-24T05:37:00.553164Z  INFO devimint::federation: Connected to 2
00:00:06 2023-09-24T05:37:00.554677Z  INFO devimint::federation: Connected to 3
00:00:06 2023-09-24T05:37:00.562817Z  INFO devimint::federation: calling set_config_gen_connections for 1 random-5Cz4H1
00:00:06 2023-09-24T05:37:00.570977Z  INFO devimint::federation: calling set_config_gen_connections for 2 random-V3Qj32
00:00:06 2023-09-24T05:37:00.578716Z  INFO devimint::federation: calling set_config_gen_connections for 3 random-BHCYb3
00:00:06 2023-09-24T05:37:00.608587Z  INFO devimint::federation: Running DKG...
00:00:09 2023-09-24T05:37:03.656634Z  INFO devimint::federation: DKG successfully complete. Starting consensus...
00:00:09 2023-09-24T05:37:03.669149Z ERROR jsonrpsee_core::client::async_client: [backend]: Networking or low-level protocol error: WebSocket connection error: connection closed
00:00:09 2023-09-24T05:37:03.997479Z  INFO devimint: lightning started
00:00:10 2023-09-24T05:37:04.700665Z ERROR jsonrpsee_core::client::async_client: [backend]: Networking or low-level protocol error: WebSocket connection error: connection closed
00:00:10 2023-09-24T05:37:04.701617Z  INFO devimint::federation: Error calling start_consensus: FederationError { general: Some(Received errors from 1 peers: peer-0: Rpc error: The background task been terminated because: Networking or low-level protocol error: WebSocket connection error: connection closed; restart required), peers: {PeerId(0): Rpc(RestartNeeded("Networking or low-level protocol error: WebSocket connection error: connection closed"))} }, trying to continue...
00:00:10 2023-09-24T05:37:04.701914Z  WARN net::api: Unable to connect to peer peer_id=0 err=Networking or low-level protocol error: Error when opening the TCP socket: Connection refused (os error 111)
00:00:11 2023-09-24T05:37:05.223517Z  INFO devimint: block sync done
00:00:11 2023-09-24T05:37:05.229053Z  INFO devimint: Sending funds from bitcoind amount=100000000 addr="bcrt1qxk00wwxe7qxrxxfwk6gs9e7g63walgr25g0wv2"
00:00:11 2023-09-24T05:37:05.241512Z  INFO devimint: Mining bitcoin blocks block_num=10
00:00:11 2023-09-24T05:37:05.780370Z ERROR jsonrpsee_core::client::async_client: [backend]: Networking or low-level protocol error: WebSocket connection error: connection closed
00:00:12 2023-09-24T05:37:06.784487Z  WARN net::api: Unable to connect to peer peer_id=0 err=Networking or low-level protocol error: Error when opening the TCP socket: Connection refused (os error 111)
00:00:12 2023-09-24T05:37:06.945263Z  INFO devimint: Mining bitcoin blocks block_num=10
00:00:13 2023-09-24T05:37:07.515970Z  WARN devimint::external: Empty chan info edge=ChannelEdge { channel_id: 123145302376449, chan_point: "3d5074de47b368f0d3805f56e817bc1a07f9ff9e368b255e6573453f65a1dec9:1", last_update: 1695533827, node1_pub: "030c631e6dcb529221617bc55838e768cf50c81430c2f821f03fdd54c7d50fdb04", node2_pub: "03b32bf4a9511d37b6efbdddba3a201c09def7c0c9a9ce37fc1d35b52f3e1156db", capacity: 10000000, node1_policy: None, node2_policy: Some(RoutingPolicy { time_lock_delta: 80, min_htlc: 1000, fee_base_msat: 1000, fee_rate_milli_msat: 1, disabled: false, max_htlc_msat: 10000000000, last_update: 1695533827 }) }
00:00:13 2023-09-24T05:37:07.796755Z ERROR jsonrpsee_core::client::async_client: [backend]: Networking or low-level protocol error: WebSocket connection error: connection closed
00:00:13 2023-09-24T05:37:07.797167Z  INFO devimint::federation: Error calling start_consensus: FederationError { general: Some(Received errors from 1 peers: peer-0: Rpc error: The background task been terminated because: Networking or low-level protocol error: WebSocket connection error: connection closed; restart required), peers: {PeerId(0): Rpc(RestartNeeded("Networking or low-level protocol error: WebSocket connection error: connection closed"))} }, trying to continue...
00:00:13 2023-09-24T05:37:07.797445Z  WARN net::api: Unable to connect to peer peer_id=0 err=Networking or low-level protocol error: Error when opening the TCP socket: Connection refused (os error 111)
00:00:14 2023-09-24T05:37:08.327829Z  WARN devimint::external: Empty chan info edge=ChannelEdge { channel_id: 123145302376449, chan_point: "3d5074de47b368f0d3805f56e817bc1a07f9ff9e368b255e6573453f65a1dec9:1", last_update: 1695533827, node1_pub: "030c631e6dcb529221617bc55838e768cf50c81430c2f821f03fdd54c7d50fdb04", node2_pub: "03b32bf4a9511d37b6efbdddba3a201c09def7c0c9a9ce37fc1d35b52f3e1156db", capacity: 10000000, node1_policy: None, node2_policy: Some(RoutingPolicy { time_lock_delta: 80, min_htlc: 1000, fee_base_msat: 1000, fee_rate_milli_msat: 1, disabled: false, max_htlc_msat: 10000000000, last_update: 1695533827 }) }
00:00:14 2023-09-24T05:37:08.807516Z  INFO devimint::federation: Consensus is running
00:00:14 2023-09-24T05:37:08.809939Z  INFO devimint::federation: copied client configs
00:00:15 2023-09-24T05:37:09.538902Z  INFO devimint: gateways started
00:00:15 2023-09-24T05:37:09.538947Z  INFO devimint: federation and gateways started
00:00:15 2023-09-24T05:37:09.556191Z  INFO devimint: Joining federation with the main client
00:00:16 2023-09-24T05:37:10.177580Z  INFO devimint: Generating first epoch
00:00:16 2023-09-24T05:37:10.214287Z  INFO devimint: Mining bitcoin blocks block_num=10
00:00:17 2023-09-24T05:37:11.610785Z  INFO devimint: await gateways registered
00:00:18 2023-09-24T05:37:12.384881Z  INFO devimint: gateways registered
00:00:18 2023-09-24T05:37:12.920849Z  INFO devimint::federation: Using cln gateway
00:00:18 2023-09-24T05:37:12.920886Z  INFO devimint: starting dev federation took 17.54527194s
00:00:18 2023-09-24T05:37:12.980219Z  INFO devimint: sending SIGKILL to gatewayd-cln and waiting for it to exit
00:00:18 2023-09-24T05:37:12.987907Z  INFO devimint: sending SIGKILL to gatewayd-lnd and waiting for it to exit
00:00:45 2023-09-24T05:37:39.089732Z  INFO devimint: CLN Gateway restarted, with auto-rejoin to federation
00:00:45 2023-09-24T05:37:39.120165Z  INFO devimint: LND Gateway restarted, with auto-rejoin to federation
00:00:45 2023-09-24T05:37:39.120245Z  INFO devimint: gateway_reboot_test: success LOG_DEVIMINT="devimint"
00:00:45 2023-09-24T05:37:39.120278Z  INFO devimint: sending SIGKILL to gatewayd-lnd and waiting for it to exit
00:00:45 2023-09-24T05:37:39.126453Z  INFO devimint: sending SIGKILL to gatewayd-cln and waiting for it to exit
00:00:45 2023-09-24T05:37:39.131904Z  INFO devimint: sending SIGKILL to faucet and waiting for it to exit
00:00:45 2023-09-24T05:37:39.132747Z  INFO devimint: sending SIGKILL to esplora and waiting for it to exit
00:00:45 2023-09-24T05:37:39.134101Z  INFO devimint: sending SIGKILL to electrs and waiting for it to exit
00:00:45 2023-09-24T05:37:39.135065Z  INFO devimint: sending SIGKILL to fedimintd-0 and waiting for it to exit
00:00:45 2023-09-24T05:37:39.139584Z  INFO devimint: sending SIGKILL to fedimintd-1 and waiting for it to exit
00:00:45 2023-09-24T05:37:39.143515Z  INFO devimint: sending SIGKILL to fedimintd-2 and waiting for it to exit
00:00:45 2023-09-24T05:37:39.147128Z  INFO devimint: sending SIGKILL to fedimintd-3 and waiting for it to exit
00:00:45 2023-09-24T05:37:39.150695Z  INFO devimint: sending SIGKILL to lnd and waiting for it to exit
00:00:45 2023-09-24T05:37:39.156628Z  INFO devimint: sending SIGTERM to lightningd and waiting for it to exit
00:00:45 2023-09-24T05:37:39.157401Z  INFO devimint: sending SIGKILL to bitcoind and waiting for it to exit
## COMPLETE: gateway_reboot_test
## START: load_test_tool_test
00:00:00 Setting up env variables in /tmp/nix-shell.mCrVBQ/nix-shell.bWG9jl/fm-YCjH
00:00:00     Finished dev [unoptimized + debuginfo] target(s) in 0.33s
00:00:00 2023-09-24T05:37:05.428313Z  INFO devimint: Test setup in "/tmp/nix-shell.mCrVBQ/nix-shell.bWG9jl/fm-YCjH/cfg"
00:00:00 2023-09-24T05:37:05.429878Z  WARN devimint: Failed to create wallet ... retrying JSON-RPC error: transport error: Couldn't connect to host: Connection refused (os error 111)
00:00:03 2023-09-24T05:37:08.650547Z  INFO devimint: electrs started
00:00:03 2023-09-24T05:37:08.651619Z  INFO devimint: esplora started
00:00:03 2023-09-24T05:37:08.651666Z  INFO devimint::federation: fedimintd-0 started
00:00:03 2023-09-24T05:37:08.676302Z  INFO devimint::federation: fedimintd-2 started
00:00:03 2023-09-24T05:37:08.679929Z  INFO devimint::federation: fedimintd-3 started
00:00:03 2023-09-24T05:37:08.688816Z  INFO devimint::federation: fedimintd-1 started
00:00:03 2023-09-24T05:37:08.694824Z  WARN net::api: Unable to connect to peer peer_id=0 err=Networking or low-level protocol error: Error when opening the TCP socket: Connection refused (os error 111)
00:00:04 2023-09-24T05:37:09.710593Z  INFO devimint::federation: Connected to 0
00:00:04 2023-09-24T05:37:09.721337Z  INFO devimint::federation: Connected to 1
00:00:04 2023-09-24T05:37:09.740315Z  INFO devimint::federation: Connected to 2
00:00:04 2023-09-24T05:37:09.747263Z  INFO devimint::federation: Connected to 3
00:00:04 2023-09-24T05:37:09.788167Z  INFO devimint::federation: calling set_config_gen_connections for 1 random-xjOPI1
00:00:04 2023-09-24T05:37:09.800528Z  INFO devimint::federation: calling set_config_gen_connections for 2 random-zeOQX2
00:00:04 2023-09-24T05:37:09.831381Z  INFO devimint::federation: calling set_config_gen_connections for 3 random-PG4fc3
00:00:04 2023-09-24T05:37:09.877026Z  INFO devimint::federation: Running DKG...
00:00:09 2023-09-24T05:37:14.039329Z  INFO devimint::federation: DKG successfully complete. Starting consensus...
00:00:09 2023-09-24T05:37:14.047766Z ERROR jsonrpsee_core::client::async_client: [backend]: Networking or low-level protocol error: WebSocket connection error: connection closed
00:00:09 2023-09-24T05:37:14.048203Z  INFO devimint::federation: Error calling start_consensus: FederationError { general: Some(Received errors from 1 peers: peer-0: Rpc error: The background task been terminated because: Networking or low-level protocol error: WebSocket connection error: connection closed; restart required), peers: {PeerId(0): Rpc(RestartNeeded("Networking or low-level protocol error: WebSocket connection error: connection closed"))} }, trying to continue...
00:00:09 2023-09-24T05:37:14.048588Z  WARN net::api: Unable to connect to peer peer_id=0 err=Networking or low-level protocol error: Error when opening the TCP socket: Connection refused (os error 111)
00:00:10 2023-09-24T05:37:15.100120Z ERROR jsonrpsee_core::client::async_client: [backend]: Networking or low-level protocol error: WebSocket connection error: connection closed
00:00:10 2023-09-24T05:37:15.152877Z  INFO devimint: lightning started
00:00:10 2023-09-24T05:37:15.598634Z  INFO devimint: block sync done
00:00:10 2023-09-24T05:37:15.615991Z  INFO devimint: Sending funds from bitcoind amount=100000000 addr="bcrt1q8aat69plpzvhr5cd0j4sx96rkv9xf7zsj9uwud"
00:00:10 2023-09-24T05:37:15.632494Z  INFO devimint: Mining bitcoin blocks block_num=10
00:00:10 2023-09-24T05:37:15.901680Z  INFO devimint: Mining bitcoin blocks block_num=10
00:00:11 2023-09-24T05:37:16.113973Z ERROR jsonrpsee_core::client::async_client: [backend]: Networking or low-level protocol error: WebSocket connection error: connection closed
00:00:11 2023-09-24T05:37:16.114832Z  INFO devimint::federation: Error calling start_consensus: FederationError { general: Some(Received errors from 1 peers: peer-0: Rpc error: The background task been terminated because: Networking or low-level protocol error: WebSocket connection error: connection closed; restart required), peers: {PeerId(0): Rpc(RestartNeeded("Networking or low-level protocol error: WebSocket connection error: connection closed"))} }, trying to continue...
00:00:11 2023-09-24T05:37:16.115132Z  WARN net::api: Unable to connect to peer peer_id=0 err=Networking or low-level protocol error: Error when opening the TCP socket: Connection refused (os error 111)
00:00:12 2023-09-24T05:37:17.144163Z ERROR jsonrpsee_core::client::async_client: [backend]: Networking or low-level protocol error: WebSocket connection error: connection closed
00:00:12 2023-09-24T05:37:17.211182Z  INFO devimint: gateways started
00:00:13 2023-09-24T05:37:18.138408Z  INFO devimint::federation: Consensus is running
00:00:13 2023-09-24T05:37:18.138847Z  INFO devimint::federation: copied client configs
00:00:13 2023-09-24T05:37:18.138883Z  INFO devimint: federation and gateways started
00:00:13 2023-09-24T05:37:18.139607Z  INFO devimint: Joining federation with the main client
00:00:15 2023-09-24T05:37:20.434226Z  INFO devimint: Generating first epoch
00:00:15 2023-09-24T05:37:20.471073Z  INFO devimint: Mining bitcoin blocks block_num=10
00:00:16 2023-09-24T05:37:21.252048Z  INFO devimint: await gateways registered
00:00:16 2023-09-24T05:37:21.486900Z  INFO devimint: gateways registered
00:00:16 2023-09-24T05:37:21.762556Z  INFO devimint::federation: Using cln gateway
00:00:16 2023-09-24T05:37:21.762619Z  INFO devimint: starting dev federation took 16.334135627s
00:00:16 2023-09-24T05:37:21.762658Z  INFO devimint::federation: Peg-in amount=10000
00:00:16 2023-09-24T05:37:21.972591Z  INFO devimint: Sending funds from bitcoind amount=10000 addr="bcrt1qkxhvq6jffl0m4yj84ua9t58l5uv8vzkvas2xke0jmmk7rlm33lqsp285am"
00:00:17 2023-09-24T05:37:22.020136Z  INFO devimint: Mining bitcoin blocks block_num=21
00:00:33 1 gateway_pay_invoice: avg 4.112932399s, median 4.112932399s, max 4.112932399s, min 4.112932399s
00:00:33 2 reissue_notes: avg 2.474872659s, median 2.628988959s, max 2.628988959s, min 2.320756359s
00:00:43 1 gateway_pay_invoice: avg 3.253907983s, median 3.253907983s, max 3.253907983s, min 3.253907983s (compared to previous: avg: -20.89%, median: -20.89%, max: -20.89%, min: -20.89%)
00:00:43 2 reissue_notes: avg 2.035912455s, median 2.159050366s, max 2.159050366s, min 1.912774544s (compared to previous: avg: -17.74%, median: -17.85%, max: -17.85%, min: -17.59%)
00:00:43 2023-09-24T05:37:48.445148Z  INFO devimint: sending SIGKILL to fedimintd-0 and waiting for it to exit
00:00:43 2023-09-24T05:37:48.450554Z  INFO devimint: sending SIGKILL to fedimintd-1 and waiting for it to exit
00:00:43 2023-09-24T05:37:48.457269Z  INFO devimint: sending SIGKILL to fedimintd-2 and waiting for it to exit
00:00:43 2023-09-24T05:37:48.462437Z  INFO devimint: sending SIGKILL to fedimintd-3 and waiting for it to exit
00:00:43 2023-09-24T05:37:48.469148Z  INFO devimint: sending SIGKILL to gatewayd-cln and waiting for it to exit
00:00:43 2023-09-24T05:37:48.486437Z  INFO devimint: sending SIGTERM to lightningd and waiting for it to exit
00:00:43 2023-09-24T05:37:48.488409Z  INFO devimint: sending SIGKILL to gatewayd-lnd and waiting for it to exit
00:00:43 2023-09-24T05:37:48.501421Z  INFO devimint: sending SIGKILL to lnd and waiting for it to exit
00:00:43 2023-09-24T05:37:48.504235Z  INFO devimint: sending SIGKILL to electrs and waiting for it to exit
00:00:43 2023-09-24T05:37:48.505494Z  INFO devimint: sending SIGKILL to esplora and waiting for it to exit
00:00:43 2023-09-24T05:37:48.506775Z  INFO devimint: sending SIGKILL to bitcoind and waiting for it to exit
00:00:43 2023-09-24T05:37:48.511285Z  INFO devimint: sending SIGKILL to faucet and waiting for it to exit
## COMPLETE: load_test_tool_test
## START: devimint_cli_test
00:00:00 Setting up env variables in /tmp/nix-shell.mCrVBQ/nix-shell.bWG9jl/fm-fPIV
00:00:01     Finished dev [unoptimized + debuginfo] target(s) in 0.33s
00:00:01 2023-09-24T05:37:00.086648Z  INFO devimint: Test setup in "/tmp/nix-shell.mCrVBQ/nix-shell.bWG9jl/fm-fPIV/cfg"
00:00:01 2023-09-24T05:37:00.087748Z  WARN devimint: Failed to create wallet ... retrying JSON-RPC error: transport error: Couldn't connect to host: Connection refused (os error 111)
00:00:05 2023-09-24T05:37:04.431828Z  INFO devimint: electrs started
00:00:05 2023-09-24T05:37:04.432959Z  INFO devimint: esplora started
00:00:05 2023-09-24T05:37:04.433009Z  INFO devimint::federation: fedimintd-2 started
00:00:05 2023-09-24T05:37:04.440357Z  INFO devimint::federation: fedimintd-0 started
00:00:05 2023-09-24T05:37:04.442268Z  INFO devimint::federation: fedimintd-3 started
00:00:05 2023-09-24T05:37:04.451829Z  INFO devimint::federation: fedimintd-1 started
00:00:05 2023-09-24T05:37:04.453065Z  WARN net::api: Unable to connect to peer peer_id=0 err=Networking or low-level protocol error: Error when opening the TCP socket: Connection refused (os error 111)
00:00:06 2023-09-24T05:37:05.456728Z  INFO devimint::federation: Connected to 0
00:00:06 2023-09-24T05:37:05.458250Z  INFO devimint::federation: Connected to 1
00:00:06 2023-09-24T05:37:05.459763Z  INFO devimint::federation: Connected to 2
00:00:06 2023-09-24T05:37:05.461257Z  INFO devimint::federation: Connected to 3
00:00:06 2023-09-24T05:37:05.469593Z  INFO devimint::federation: calling set_config_gen_connections for 1 random-uImSP1
00:00:06 2023-09-24T05:37:05.477163Z  INFO devimint::federation: calling set_config_gen_connections for 2 random-AdUbo2
00:00:06 2023-09-24T05:37:05.483828Z  INFO devimint::federation: calling set_config_gen_connections for 3 random-KUA6M3
00:00:06 2023-09-24T05:37:05.511334Z  INFO devimint::federation: Running DKG...
00:00:08 2023-09-24T05:37:07.780294Z  INFO devimint::federation: DKG successfully complete. Starting consensus...
00:00:08 2023-09-24T05:37:07.787386Z ERROR jsonrpsee_core::client::async_client: [backend]: Networking or low-level protocol error: WebSocket connection error: connection closed
00:00:08 2023-09-24T05:37:07.787641Z  INFO devimint::federation: Error calling start_consensus: FederationError { general: Some(Received errors from 1 peers: peer-0: Rpc error: The background task been terminated because: Networking or low-level protocol error: WebSocket connection error: connection closed; restart required), peers: {PeerId(0): Rpc(RestartNeeded("Networking or low-level protocol error: WebSocket connection error: connection closed"))} }, trying to continue...
00:00:08 2023-09-24T05:37:07.787896Z  WARN net::api: Unable to connect to peer peer_id=0 err=Networking or low-level protocol error: Error when opening the TCP socket: Connection refused (os error 111)
00:00:09 2023-09-24T05:37:08.801215Z ERROR jsonrpsee_core::client::async_client: [backend]: Networking or low-level protocol error: WebSocket connection error: connection closed
00:00:09 2023-09-24T05:37:08.805098Z  WARN net::api: Unable to connect to peer peer_id=0 err=Networking or low-level protocol error: Error when opening the TCP socket: Connection refused (os error 111)
00:00:09 2023-09-24T05:37:08.909250Z  INFO devimint: lightning started
00:00:10 2023-09-24T05:37:09.421569Z  INFO devimint: block sync done
00:00:10 2023-09-24T05:37:09.429992Z  INFO devimint: Sending funds from bitcoind amount=100000000 addr="bcrt1qzpwhncf8na4ru9jyqwdkj28u2zpx9d4qzenma9"
00:00:10 2023-09-24T05:37:09.457588Z  INFO devimint: Mining bitcoin blocks block_num=10
00:00:10 2023-09-24T05:37:09.835919Z ERROR jsonrpsee_core::client::async_client: [backend]: Networking or low-level protocol error: WebSocket connection error: connection closed
00:00:10 2023-09-24T05:37:09.836767Z  INFO devimint::federation: Error calling start_consensus: FederationError { general: Some(Received errors from 1 peers: peer-0: Rpc error: The background task been terminated because: Networking or low-level protocol error: WebSocket connection error: connection closed; restart required), peers: {PeerId(0): Rpc(RestartNeeded("Networking or low-level protocol error: WebSocket connection error: connection closed"))} }, trying to continue...
00:00:10 2023-09-24T05:37:09.837136Z  WARN net::api: Unable to connect to peer peer_id=0 err=Networking or low-level protocol error: Error when opening the TCP socket: Connection refused (os error 111)
00:00:11 2023-09-24T05:37:10.840471Z  WARN net::api: Unable to connect to peer peer_id=0 err=Networking or low-level protocol error: Error when opening the TCP socket: Connection refused (os error 111)
00:00:12 2023-09-24T05:37:11.345668Z  INFO devimint: Mining bitcoin blocks block_num=10
00:00:12 2023-09-24T05:37:11.915330Z ERROR jsonrpsee_core::client::async_client: [backend]: Networking or low-level protocol error: WebSocket connection error: connection closed
00:00:12 2023-09-24T05:37:11.916600Z  INFO devimint::federation: Error calling start_consensus: FederationError { general: Some(Received errors from 1 peers: peer-0: Rpc error: The background task been terminated because: Networking or low-level protocol error: WebSocket connection error: connection closed; restart required), peers: {PeerId(0): Rpc(RestartNeeded("Networking or low-level protocol error: WebSocket connection error: connection closed"))} }, trying to continue...
00:00:12 2023-09-24T05:37:11.917192Z  WARN net::api: Unable to connect to peer peer_id=0 err=Networking or low-level protocol error: Error when opening the TCP socket: Connection refused (os error 111)
00:00:13 2023-09-24T05:37:12.920430Z  WARN net::api: Unable to connect to peer peer_id=0 err=Networking or low-level protocol error: Error when opening the TCP socket: Connection refused (os error 111)
00:00:14 2023-09-24T05:37:13.044962Z  INFO devimint: gateways started
00:00:14 2023-09-24T05:37:13.923368Z  INFO devimint::federation: Consensus is running
00:00:14 2023-09-24T05:37:13.923714Z  INFO devimint::federation: copied client configs
00:00:14 2023-09-24T05:37:13.923740Z  INFO devimint: federation and gateways started
00:00:14 2023-09-24T05:37:13.928438Z  INFO devimint: Joining federation with the main client
00:00:15 2023-09-24T05:37:14.313212Z  INFO devimint: Generating first epoch
00:00:15 2023-09-24T05:37:14.343583Z  INFO devimint: Mining bitcoin blocks block_num=10
00:00:15 2023-09-24T05:37:14.994821Z  INFO devimint: await gateways registered
00:00:16 2023-09-24T05:37:15.296351Z  INFO devimint: gateways registered
00:00:16 2023-09-24T05:37:15.575032Z  INFO devimint::federation: Using cln gateway
00:00:16 2023-09-24T05:37:15.575083Z  INFO devimint: starting dev federation took 15.488314628s
00:00:16 2023-09-24T05:37:15.651120Z  INFO devimint: Testing load last epoch with admin client
00:00:17 2023-09-24T05:37:16.040349Z  INFO devimint::federation: Pegging-in gateway funds amount=99999
00:00:17 2023-09-24T05:37:16.089655Z  INFO devimint: Sending funds from bitcoind amount=99999 addr="bcrt1qu5e6ww6q7apsq7mg62972y87wtgtz7k0sx86jkrz8zw2lr8f56xqsgqkvq"
00:00:17 2023-09-24T05:37:16.111950Z  INFO devimint: Mining bitcoin blocks block_num=21
00:00:26 2023-09-24T05:37:25.292222Z  INFO devimint: Testing LND can pay CLN directly
00:00:26 2023-09-24T05:37:25.647424Z  INFO devimint: Testing CLN can pay LND directly
00:00:27 2023-09-24T05:37:26.224297Z  INFO devimint: Testing Client
00:00:27 2023-09-24T05:37:26.224337Z  INFO devimint: Testing reissuing e-cash
00:00:27 2023-09-24T05:37:26.420478Z  INFO devimint::federation: Peg-in amount=420
00:00:27 2023-09-24T05:37:26.559904Z  INFO devimint: Sending funds from bitcoind amount=420 addr="bcrt1q2ew2h20mmq7wv88dx7qs76kyfy053gqmsljgknefrf8gp7yk4naqecay4l"
00:00:27 2023-09-24T05:37:26.575017Z  INFO devimint: Mining bitcoin blocks block_num=21
00:00:33 2023-09-24T05:37:32.630887Z  INFO devimint: Testing backup&restore
00:00:40 2023-09-24T05:37:39.417213Z  INFO devimint: Testing spending from client
00:00:43 2023-09-24T05:37:42.372362Z  INFO devimint: Testing reissuing e-cash after spending
00:00:46 2023-09-24T05:37:45.090387Z  INFO devimint: Testing reissuing e-cash via module commands
00:00:48 2023-09-24T05:37:47.533036Z  INFO devimint: Testing fedimint-cli pays LND via CLN gateway
00:00:48 2023-09-24T05:37:47.789746Z  INFO devimint::federation: Using cln gateway
00:00:55 2023-09-24T05:37:54.766947Z  INFO devimint: Testing receiving e-cash notes
00:00:58 2023-09-24T05:37:57.410363Z  INFO devimint: Testing LND gateway
00:00:58 2023-09-24T05:37:57.589341Z  INFO devimint::federation: Using lnd gateway
00:00:58 2023-09-24T05:37:57.589394Z  INFO devimint: Testing outgoing payment from client to CLN via LND gateway
00:01:02 2023-09-24T05:38:01.388048Z  INFO devimint: Testing incoming payment from CLN to client via LND gateway
00:01:06 2023-09-24T05:38:05.464475Z  INFO devimint: Testing receiving ecash notes
00:01:09 2023-09-24T05:38:08.006061Z  INFO devimint: Testing client deposit
00:01:09 2023-09-24T05:38:08.154965Z  INFO devimint::federation: Peg-in amount=100000
00:01:09 2023-09-24T05:38:08.289855Z  INFO devimint: Sending funds from bitcoind amount=100000 addr="bcrt1qxaxu3tljk5csr4wm63505277atmhq4z9qe98ghk9nj59ecsggrpqrhkyhx"
00:01:09 2023-09-24T05:38:08.305731Z  INFO devimint: Mining bitcoin blocks block_num=21
00:01:14 2023-09-24T05:38:13.270797Z  INFO devimint: Testing client withdraw
00:01:16 2023-09-24T05:38:15.463299Z  INFO devimint: sending SIGKILL to faucet and waiting for it to exit
00:01:16 2023-09-24T05:38:15.464227Z  INFO devimint: sending SIGKILL to esplora and waiting for it to exit
00:01:16 2023-09-24T05:38:15.465499Z  INFO devimint: sending SIGKILL to electrs and waiting for it to exit
00:01:16 2023-09-24T05:38:15.466449Z  INFO devimint: sending SIGKILL to gatewayd-lnd and waiting for it to exit
00:01:16 2023-09-24T05:38:15.472173Z  INFO devimint: sending SIGKILL to gatewayd-cln and waiting for it to exit
00:01:16 2023-09-24T05:38:15.476776Z  INFO devimint: sending SIGKILL to fedimintd-0 and waiting for it to exit
00:01:16 2023-09-24T05:38:15.481478Z  INFO devimint: sending SIGKILL to fedimintd-1 and waiting for it to exit
00:01:16 2023-09-24T05:38:15.485380Z  INFO devimint: sending SIGKILL to fedimintd-2 and waiting for it to exit
00:01:16 2023-09-24T05:38:15.489606Z  INFO devimint: sending SIGKILL to fedimintd-3 and waiting for it to exit
00:01:16 2023-09-24T05:38:15.493608Z  INFO devimint: sending SIGKILL to lnd and waiting for it to exit
00:01:16 2023-09-24T05:38:15.499805Z  INFO devimint: sending SIGTERM to lightningd and waiting for it to exit
00:01:16 2023-09-24T05:38:15.500736Z  INFO devimint: sending SIGKILL to bitcoind and waiting for it to exit
## COMPLETE: devimint_cli_test
## START: latency_test
00:00:00 Setting up env variables in /tmp/nix-shell.mCrVBQ/nix-shell.bWG9jl/fm-rrEP
00:00:00     Finished dev [unoptimized + debuginfo] target(s) in 0.22s
00:00:00 2023-09-24T05:36:38.639140Z  INFO devimint: Test setup in "/tmp/nix-shell.mCrVBQ/nix-shell.bWG9jl/fm-rrEP/cfg"
00:00:00 2023-09-24T05:36:38.640310Z  WARN devimint: Failed to create wallet ... retrying JSON-RPC error: transport error: Couldn't connect to host: Connection refused (os error 111)
00:00:03 2023-09-24T05:36:41.232320Z  INFO devimint: electrs started
00:00:03 2023-09-24T05:36:41.233107Z  INFO devimint: esplora started
00:00:03 2023-09-24T05:36:41.233146Z  INFO devimint::federation: fedimintd-3 started
00:00:03 2023-09-24T05:36:41.236319Z  INFO devimint::federation: fedimintd-0 started
00:00:03 2023-09-24T05:36:41.236988Z  INFO devimint::federation: fedimintd-1 started
00:00:03 2023-09-24T05:36:41.238525Z  INFO devimint::federation: fedimintd-2 started
00:00:03 2023-09-24T05:36:41.239527Z  WARN net::api: Unable to connect to peer peer_id=0 err=Networking or low-level protocol error: Error when opening the TCP socket: Connection refused (os error 111)
00:00:04 2023-09-24T05:36:42.243441Z  INFO devimint::federation: Connected to 0
00:00:04 2023-09-24T05:36:42.245357Z  INFO devimint::federation: Connected to 1
00:00:04 2023-09-24T05:36:42.247004Z  INFO devimint::federation: Connected to 2
00:00:04 2023-09-24T05:36:42.248582Z  INFO devimint::federation: Connected to 3
00:00:04 2023-09-24T05:36:42.256704Z  INFO devimint::federation: calling set_config_gen_connections for 1 random-tk1UB1
00:00:04 2023-09-24T05:36:42.263954Z  INFO devimint::federation: calling set_config_gen_connections for 2 random-90anI2
00:00:04 2023-09-24T05:36:42.271688Z  INFO devimint::federation: calling set_config_gen_connections for 3 random-r6HZb3
00:00:04 2023-09-24T05:36:42.298594Z  INFO devimint::federation: Running DKG...
00:00:06 2023-09-24T05:36:44.466813Z  INFO devimint::federation: DKG successfully complete. Starting consensus...
00:00:06 2023-09-24T05:36:44.473355Z ERROR jsonrpsee_core::client::async_client: [backend]: Networking or low-level protocol error: WebSocket connection error: connection closed
00:00:06 2023-09-24T05:36:44.473626Z  INFO devimint::federation: Error calling start_consensus: FederationError { general: Some(Received errors from 1 peers: peer-0: Rpc error: The background task been terminated because: Networking or low-level protocol error: WebSocket connection error: connection closed; restart required), peers: {PeerId(0): Rpc(RestartNeeded("Networking or low-level protocol error: WebSocket connection error: connection closed"))} }, trying to continue...
00:00:06 2023-09-24T05:36:44.473892Z  WARN net::api: Unable to connect to peer peer_id=0 err=Networking or low-level protocol error: Error when opening the TCP socket: Connection refused (os error 111)
00:00:07 2023-09-24T05:36:45.485480Z ERROR jsonrpsee_core::client::async_client: [backend]: Networking or low-level protocol error: WebSocket connection error: connection closed
00:00:07 2023-09-24T05:36:45.485693Z  INFO devimint::federation: Error calling start_consensus: FederationError { general: Some(Received errors from 1 peers: peer-0: Rpc error: The background task been terminated because: Networking or low-level protocol error: WebSocket connection error: connection closed; restart required), peers: {PeerId(0): Rpc(RestartNeeded("Networking or low-level protocol error: WebSocket connection error: connection closed"))} }, trying to continue...
00:00:07 2023-09-24T05:36:45.485927Z  WARN net::api: Unable to connect to peer peer_id=0 err=Networking or low-level protocol error: Error when opening the TCP socket: Connection refused (os error 111)
00:00:07 2023-09-24T05:36:45.686255Z  INFO devimint: lightning started
00:00:07 2023-09-24T05:36:45.689327Z  INFO devimint: block sync done
00:00:07 2023-09-24T05:36:45.699392Z  INFO devimint: Sending funds from bitcoind amount=100000000 addr="bcrt1qe0q89gjjalh7td5n2yh0v79h7a54t3wv7zvqcf"
00:00:07 2023-09-24T05:36:45.718136Z  INFO devimint: Mining bitcoin blocks block_num=10
00:00:07 2023-09-24T05:36:45.993260Z  INFO devimint: Mining bitcoin blocks block_num=10
00:00:08 2023-09-24T05:36:46.495940Z ERROR jsonrpsee_core::client::async_client: [backend]: Networking or low-level protocol error: WebSocket connection error: connection closed
00:00:08 2023-09-24T05:36:46.496209Z  INFO devimint::federation: Error calling start_consensus: FederationError { general: Some(Received errors from 1 peers: peer-0: Rpc error: The background task been terminated because: Networking or low-level protocol error: WebSocket connection error: connection closed; restart required), peers: {PeerId(0): Rpc(RestartNeeded("Networking or low-level protocol error: WebSocket connection error: connection closed"))} }, trying to continue...
00:00:08 2023-09-24T05:36:46.496430Z  WARN net::api: Unable to connect to peer peer_id=0 err=Networking or low-level protocol error: Error when opening the TCP socket: Connection refused (os error 111)
00:00:09 2023-09-24T05:36:47.312349Z  INFO devimint: gateways started
00:00:09 2023-09-24T05:36:47.509054Z ERROR jsonrpsee_core::client::async_client: [backend]: Networking or low-level protocol error: WebSocket connection error: connection closed
00:00:09 2023-09-24T05:36:47.509344Z  INFO devimint::federation: Error calling start_consensus: FederationError { general: Some(Received errors from 1 peers: peer-0: Rpc error: The background task been terminated because: Networking or low-level protocol error: WebSocket connection error: connection closed; restart required), peers: {PeerId(0): Rpc(RestartNeeded("Networking or low-level protocol error: WebSocket connection error: connection closed"))} }, trying to continue...
00:00:09 2023-09-24T05:36:47.509721Z  WARN net::api: Unable to connect to peer peer_id=0 err=Networking or low-level protocol error: Error when opening the TCP socket: Connection refused (os error 111)
00:00:10 2023-09-24T05:36:48.520855Z  WARN net::api: Unable to connect to peer peer_id=0 err=Networking or low-level protocol error: Error when opening the TCP socket: Connection refused (os error 111)
00:00:11 2023-09-24T05:36:49.526152Z  INFO devimint::federation: Consensus is running
00:00:11 2023-09-24T05:36:49.526506Z  INFO devimint::federation: copied client configs
00:00:11 2023-09-24T05:36:49.526533Z  INFO devimint: federation and gateways started
00:00:11 2023-09-24T05:36:49.534450Z  INFO devimint: Joining federation with the main client
00:00:13 2023-09-24T05:36:51.024187Z  INFO devimint: Generating first epoch
00:00:13 2023-09-24T05:36:51.052972Z  INFO devimint: Mining bitcoin blocks block_num=10
00:00:13 2023-09-24T05:36:51.424341Z  INFO devimint: await gateways registered
00:00:13 2023-09-24T05:36:51.605459Z  INFO devimint: gateways registered
00:00:13 2023-09-24T05:36:51.844602Z  INFO devimint::federation: Using cln gateway
00:00:13 2023-09-24T05:36:51.844648Z  INFO devimint: starting dev federation took 13.205390365s
00:00:13 2023-09-24T05:36:51.844670Z  INFO devimint::federation: Peg-in amount=10000000
00:00:14 2023-09-24T05:36:52.006700Z  INFO devimint: Sending funds from bitcoind amount=10000000 addr="bcrt1qa9wreeuw3khfvrsvn02hfgh3nq2rww8elx08fhm33hkasaju2lcqwa3luh"
00:00:14 2023-09-24T05:36:52.026718Z  INFO devimint: Mining bitcoin blocks block_num=21
00:02:07 ================= RESULTS ==================
00:02:07 AVG REISSUE TIME: 3.045
00:02:07 AVG LN SEND TIME: 3.967
00:02:07 AVG LN RECV TIME: 3.546
00:02:07 2023-09-24T05:38:45.015151Z  INFO devimint: sending SIGKILL to faucet and waiting for it to exit
00:02:07 2023-09-24T05:38:45.016170Z  INFO devimint: sending SIGKILL to esplora and waiting for it to exit
00:02:07 2023-09-24T05:38:45.017408Z  INFO devimint: sending SIGKILL to electrs and waiting for it to exit
00:02:07 2023-09-24T05:38:45.018353Z  INFO devimint: sending SIGKILL to gatewayd-lnd and waiting for it to exit
00:02:07 2023-09-24T05:38:45.029576Z  INFO devimint: sending SIGKILL to gatewayd-cln and waiting for it to exit
00:02:07 2023-09-24T05:38:45.036922Z  INFO devimint: sending SIGKILL to fedimintd-0 and waiting for it to exit
00:02:07 2023-09-24T05:38:45.043244Z  INFO devimint: sending SIGKILL to fedimintd-1 and waiting for it to exit
00:02:07 2023-09-24T05:38:45.049486Z  INFO devimint: sending SIGKILL to fedimintd-2 and waiting for it to exit
00:02:07 2023-09-24T05:38:45.058698Z  INFO devimint: sending SIGKILL to fedimintd-3 and waiting for it to exit
00:02:07 2023-09-24T05:38:45.064980Z  INFO devimint: sending SIGKILL to lnd and waiting for it to exit
00:02:07 2023-09-24T05:38:45.071805Z  INFO devimint: sending SIGTERM to lightningd and waiting for it to exit
00:02:07 2023-09-24T05:38:45.072723Z  INFO devimint: sending SIGKILL to bitcoind and waiting for it to exit
## COMPLETE: latency_test
## START: reconnect_test
00:00:00 Setting up env variables in /tmp/nix-shell.mCrVBQ/nix-shell.bWG9jl/fm-7ysA
00:00:00     Finished dev [unoptimized + debuginfo] target(s) in 0.30s
00:00:01 2023-09-24T05:36:44.019720Z  INFO devimint: Test setup in "/tmp/nix-shell.mCrVBQ/nix-shell.bWG9jl/fm-7ysA/cfg"
00:00:01 2023-09-24T05:36:44.021002Z  WARN devimint: Failed to create wallet ... retrying JSON-RPC error: transport error: Couldn't connect to host: Connection refused (os error 111)
00:00:03 2023-09-24T05:36:46.660148Z  INFO devimint: electrs started
00:00:03 2023-09-24T05:36:46.661114Z  INFO devimint: esplora started
00:00:03 2023-09-24T05:36:46.661154Z  INFO devimint::federation: fedimintd-1 started
00:00:03 2023-09-24T05:36:46.663494Z  INFO devimint::federation: fedimintd-3 started
00:00:03 2023-09-24T05:36:46.664082Z  INFO devimint::federation: fedimintd-2 started
00:00:03 2023-09-24T05:36:46.664628Z  INFO devimint::federation: fedimintd-0 started
00:00:03 2023-09-24T05:36:46.668386Z  WARN net::api: Unable to connect to peer peer_id=0 err=Networking or low-level protocol error: Error when opening the TCP socket: Connection refused (os error 111)
00:00:04 2023-09-24T05:36:47.672485Z  INFO devimint::federation: Connected to 0
00:00:04 2023-09-24T05:36:47.674310Z  INFO devimint::federation: Connected to 1
00:00:04 2023-09-24T05:36:47.676281Z  INFO devimint::federation: Connected to 2
00:00:04 2023-09-24T05:36:47.678099Z  INFO devimint::federation: Connected to 3
00:00:04 2023-09-24T05:36:47.687073Z  INFO devimint::federation: calling set_config_gen_connections for 1 random-2Wvap1
00:00:04 2023-09-24T05:36:47.695433Z  INFO devimint::federation: calling set_config_gen_connections for 2 random-56JEe2
00:00:04 2023-09-24T05:36:47.703004Z  INFO devimint::federation: calling set_config_gen_connections for 3 random-OlmnR3
00:00:04 2023-09-24T05:36:47.731642Z  INFO devimint::federation: Running DKG...
00:00:06 2023-09-24T05:36:49.982589Z  INFO devimint::federation: DKG successfully complete. Starting consensus...
00:00:06 2023-09-24T05:36:49.991508Z ERROR jsonrpsee_core::client::async_client: [backend]: Networking or low-level protocol error: WebSocket connection error: connection closed
00:00:06 2023-09-24T05:36:49.991782Z  INFO devimint::federation: Error calling start_consensus: FederationError { general: Some(Received errors from 1 peers: peer-0: Rpc error: The background task been terminated because: Networking or low-level protocol error: WebSocket connection error: connection closed; restart required), peers: {PeerId(0): Rpc(RestartNeeded("Networking or low-level protocol error: WebSocket connection error: connection closed"))} }, trying to continue...
00:00:06 2023-09-24T05:36:49.992054Z  WARN net::api: Unable to connect to peer peer_id=0 err=Networking or low-level protocol error: Error when opening the TCP socket: Connection refused (os error 111)
00:00:08 2023-09-24T05:36:51.005667Z ERROR jsonrpsee_core::client::async_client: [backend]: Networking or low-level protocol error: WebSocket connection error: i/o error: Transport endpoint is not connected (os error 107)
00:00:08 2023-09-24T05:36:51.005924Z  WARN net::api: Unable to connect to peer peer_id=0 err=Networking or low-level protocol error: Error when opening the TCP socket: Connection refused (os error 111)
00:00:08 2023-09-24T05:36:51.115973Z  INFO devimint: lightning started
00:00:08 2023-09-24T05:36:51.540083Z  INFO devimint: block sync done
00:00:08 2023-09-24T05:36:51.552250Z  INFO devimint: Sending funds from bitcoind amount=100000000 addr="bcrt1qphxssddmjplt4ta3qzlchq4fa5g6jlaelkttf3"
00:00:08 2023-09-24T05:36:51.575369Z  INFO devimint: Mining bitcoin blocks block_num=10
00:00:09 2023-09-24T05:36:52.017165Z ERROR jsonrpsee_core::client::async_client: [backend]: Networking or low-level protocol error: WebSocket connection error: connection closed
00:00:09 2023-09-24T05:36:52.017390Z  INFO devimint::federation: Error calling start_consensus: FederationError { general: Some(Received errors from 1 peers: peer-0: Rpc error: The background task been terminated because: Networking or low-level protocol error: WebSocket connection error: connection closed; restart required), peers: {PeerId(0): Rpc(RestartNeeded("Networking or low-level protocol error: WebSocket connection error: connection closed"))} }, trying to continue...
00:00:09 2023-09-24T05:36:52.017719Z  WARN net::api: Unable to connect to peer peer_id=0 err=Networking or low-level protocol error: Error when opening the TCP socket: Connection refused (os error 111)
00:00:10 2023-09-24T05:36:53.010428Z  INFO devimint: Mining bitcoin blocks block_num=10
00:00:10 2023-09-24T05:36:53.122466Z ERROR jsonrpsee_core::client::async_client: [backend]: Networking or low-level protocol error: WebSocket connection error: connection closed
00:00:10 2023-09-24T05:36:53.122860Z  INFO devimint::federation: Error calling start_consensus: FederationError { general: Some(Received errors from 1 peers: peer-0: Rpc error: The background task been terminated because: Networking or low-level protocol error: WebSocket connection error: connection closed; restart required), peers: {PeerId(0): Rpc(RestartNeeded("Networking or low-level protocol error: WebSocket connection error: connection closed"))} }, trying to continue...
00:00:10 2023-09-24T05:36:53.123131Z  WARN net::api: Unable to connect to peer peer_id=0 err=Networking or low-level protocol error: Error when opening the TCP socket: Connection refused (os error 111)
00:00:10 2023-09-24T05:36:53.530663Z  WARN devimint::external: Getting chan info failed e=status: Unknown, message: "edge not found", details: [], metadata: MetadataMap { headers: {"content-type": "application/grpc"} }
00:00:11 2023-09-24T05:36:54.128924Z  INFO devimint::federation: Consensus is running
00:00:11 2023-09-24T05:36:54.132191Z  INFO devimint::federation: copied client configs
00:00:11 2023-09-24T05:36:54.376532Z  INFO devimint: gateways started
00:00:11 2023-09-24T05:36:54.376577Z  INFO devimint: federation and gateways started
00:00:11 2023-09-24T05:36:54.408508Z  INFO devimint: Joining federation with the main client
00:00:13 2023-09-24T05:36:56.410037Z  INFO devimint: Generating first epoch
00:00:13 2023-09-24T05:36:56.433022Z  INFO devimint: Mining bitcoin blocks block_num=10
00:00:13 2023-09-24T05:36:56.770995Z  INFO devimint: await gateways registered
00:00:13 2023-09-24T05:36:56.980783Z  INFO devimint: gateways registered
00:00:14 2023-09-24T05:36:57.282745Z  INFO devimint::federation: Using cln gateway
00:00:14 2023-09-24T05:36:57.282874Z  INFO devimint: starting dev federation took 13.263022083s
00:00:14 2023-09-24T05:36:57.282909Z  INFO devimint: Mining bitcoin blocks block_num=110
00:00:17 2023-09-24T05:37:00.043464Z  INFO devimint: sending SIGTERM to fedimintd-0 and waiting for it to exit
00:00:52 2023-09-24T05:37:35.163679Z  INFO devimint: Mining bitcoin blocks block_num=10
00:00:53 2023-09-24T05:37:36.276315Z  INFO devimint: Mining bitcoin blocks block_num=10
00:00:54 2023-09-24T05:37:37.529045Z  INFO devimint: Mining bitcoin blocks block_num=10
00:00:55 2023-09-24T05:37:38.586696Z  INFO devimint: Mining bitcoin blocks block_num=10
00:00:56 2023-09-24T05:37:39.645971Z  INFO devimint: Mining bitcoin blocks block_num=10
00:00:57 2023-09-24T05:37:40.781578Z  INFO devimint: Mining bitcoin blocks block_num=10
00:00:58 2023-09-24T05:37:41.989220Z  INFO devimint: Mining bitcoin blocks block_num=10
00:01:00 2023-09-24T05:37:43.145962Z  INFO devimint: Mining bitcoin blocks block_num=10
00:01:01 2023-09-24T05:37:44.246416Z  INFO devimint: Mining bitcoin blocks block_num=10
00:01:02 2023-09-24T05:37:45.396810Z  INFO devimint: Mining bitcoin blocks block_num=10
00:01:03 2023-09-24T05:37:46.567120Z  INFO devimint::federation: fedimintd-0 started
00:01:03 2023-09-24T05:37:46.581939Z  INFO devimint: Mining bitcoin blocks block_num=10
00:01:04 2023-09-24T05:37:47.346849Z  INFO devimint: Mining bitcoin blocks block_num=10
00:01:04 2023-09-24T05:37:47.770044Z  INFO devimint: Mining bitcoin blocks block_num=10
00:01:05 2023-09-24T05:37:48.163333Z  INFO devimint: Mining bitcoin blocks block_num=10
00:01:05 2023-09-24T05:37:48.494635Z  INFO devimint: Mining bitcoin blocks block_num=10
00:01:05 2023-09-24T05:37:48.856822Z  INFO devimint: Mining bitcoin blocks block_num=10
00:01:06 2023-09-24T05:37:49.246749Z  INFO devimint: Mining bitcoin blocks block_num=10
00:01:06 2023-09-24T05:37:49.649937Z  INFO devimint: Mining bitcoin blocks block_num=10
00:01:07 2023-09-24T05:37:50.752947Z  INFO devimint: Mining bitcoin blocks block_num=10
00:01:08 2023-09-24T05:37:51.944121Z  INFO devimint: Mining bitcoin blocks block_num=10
00:01:09 2023-09-24T05:37:52.469814Z  INFO devimint: Server 0 successfully rejoined!
00:01:09 2023-09-24T05:37:52.469857Z  INFO devimint: Mining bitcoin blocks block_num=100
00:01:10 2023-09-24T05:37:53.878024Z  INFO devimint: sending SIGTERM to fedimintd-1 and waiting for it to exit
00:01:33 2023-09-24T05:38:16.493807Z  INFO devimint: Mining bitcoin blocks block_num=100
00:01:35 2023-09-24T05:38:18.126958Z  INFO devimint: sending SIGTERM to fedimintd-2 and waiting for it to exit
00:01:56 2023-09-24T05:38:39.931842Z  INFO devimint: sending SIGTERM to fedimintd-3 and waiting for it to exit
00:02:17 2023-09-24T05:39:00.692351Z  INFO devimint::federation: fedimintd-1 started
00:02:17 2023-09-24T05:39:00.692901Z  INFO devimint::federation: fedimintd-2 started
00:02:17 2023-09-24T05:39:00.693251Z  INFO devimint::federation: fedimintd-3 started
00:02:26 2023-09-24T05:39:09.257520Z  INFO devimint: fm success: reconnect-test
00:02:26 2023-09-24T05:39:09.257577Z  INFO devimint: sending SIGKILL to faucet and waiting for it to exit
00:02:26 2023-09-24T05:39:09.258530Z  INFO devimint: sending SIGKILL to esplora and waiting for it to exit
00:02:26 2023-09-24T05:39:09.260815Z  INFO devimint: sending SIGKILL to electrs and waiting for it to exit
00:02:26 2023-09-24T05:39:09.261947Z  INFO devimint: sending SIGKILL to gatewayd-lnd and waiting for it to exit
00:02:26 2023-09-24T05:39:09.272216Z  INFO devimint: sending SIGKILL to gatewayd-cln and waiting for it to exit
00:02:26 2023-09-24T05:39:09.283098Z  INFO devimint: sending SIGKILL to fedimintd-0 and waiting for it to exit
00:02:26 2023-09-24T05:39:09.289679Z  INFO devimint: sending SIGKILL to fedimintd-1 and waiting for it to exit
00:02:26 2023-09-24T05:39:09.295619Z  INFO devimint: sending SIGKILL to fedimintd-2 and waiting for it to exit
00:02:26 2023-09-24T05:39:09.302946Z  INFO devimint: sending SIGKILL to fedimintd-3 and waiting for it to exit
00:02:26 2023-09-24T05:39:09.308296Z  INFO devimint: sending SIGKILL to lnd and waiting for it to exit
00:02:26 2023-09-24T05:39:09.315006Z  INFO devimint: sending SIGTERM to lightningd and waiting for it to exit
00:02:26 2023-09-24T05:39:09.316042Z  INFO devimint: sending SIGKILL to bitcoind and waiting for it to exit
## COMPLETE: reconnect_test
## START: backend_test_electrs
00:00:00 Setting up env variables in /tmp/nix-shell.mCrVBQ/nix-shell.bWG9jl/fm-qv0T
00:00:00     Finished dev [unoptimized + debuginfo] target(s) in 0.24s
00:00:00 ### Setting up tests
00:00:00 2023-09-24T05:36:28.599216Z  INFO devimint: Test setup in "/tmp/nix-shell.mCrVBQ/nix-shell.bWG9jl/fm-qv0T/cfg"
00:00:00 2023-09-24T05:36:28.600275Z  WARN devimint: Failed to create wallet ... retrying JSON-RPC error: transport error: Couldn't connect to host: Connection refused (os error 111)
00:00:03 2023-09-24T05:36:31.024356Z  INFO devimint: electrs started
00:00:03 2023-09-24T05:36:31.025233Z  INFO devimint: esplora started
00:00:06 2023-09-24T05:36:34.290299Z  INFO devimint: block sync done
00:00:06 2023-09-24T05:36:34.305807Z  INFO devimint: Sending funds from bitcoind amount=100000000 addr="bcrt1qzaxhk6658wz6x6058fz6w02lsmlnjna6mz56s0"
00:00:06 2023-09-24T05:36:34.320186Z  INFO devimint: Mining bitcoin blocks block_num=10
00:00:06 2023-09-24T05:36:34.905879Z  INFO devimint: Mining bitcoin blocks block_num=10
00:00:08 2023-09-24T05:36:36.222707Z  WARN devimint::external: Empty chan info edge=ChannelEdge { channel_id: 123145302376449, chan_point: "d236557a71123123700d14735420a41b6159d69ed33b913f4ba2f100aef08ab3:1", last_update: 1695533796, node1_pub: "030915f58675a6a3c03712e8a2866b275303c1c31b1ff0d4a917db59717f96d3a5", node2_pub: "03774b2b9b35111ff6aa1f5a1e14cd280a9356e66f4b7d6a9cff3e2357f1bc4df7", capacity: 10000000, node1_policy: None, node2_policy: Some(RoutingPolicy { time_lock_delta: 80, min_htlc: 1000, fee_base_msat: 1000, fee_rate_milli_msat: 1, disabled: false, max_htlc_msat: 10000000000, last_update: 1695533796 }) }
00:00:09 2023-09-24T05:36:37.426564Z  WARN devimint::external: Empty chan info edge=ChannelEdge { channel_id: 123145302376449, chan_point: "d236557a71123123700d14735420a41b6159d69ed33b913f4ba2f100aef08ab3:1", last_update: 1695533796, node1_pub: "030915f58675a6a3c03712e8a2866b275303c1c31b1ff0d4a917db59717f96d3a5", node2_pub: "03774b2b9b35111ff6aa1f5a1e14cd280a9356e66f4b7d6a9cff3e2357f1bc4df7", capacity: 10000000, node1_policy: None, node2_policy: Some(RoutingPolicy { time_lock_delta: 80, min_htlc: 1000, fee_base_msat: 1000, fee_rate_milli_msat: 1, disabled: false, max_htlc_msat: 10000000000, last_update: 1695533796 }) }
00:00:11 2023-09-24T05:36:39.048660Z  INFO devimint: starting base daemons took 10.449305257s
00:00:11 ### Setting up tests - complete
00:00:11 ### Testing against electrs
00:00:12     Finished test [unoptimized + debuginfo] target(s) in 0.24s
00:00:12     Starting 6 tests across 52 binaries
00:01:12         SLOW [> 60.000s] fedimint-wallet-tests::fedimint_wallet_tests on_chain_peg_in_and_peg_out_happy_case
00:01:12         SLOW [> 60.000s] fedimint-wallet-tests::fedimint_wallet_tests peg_ins_that_are_unconfirmed_are_rejected
00:01:12         SLOW [> 60.000s] fedimint-wallet-tests::fedimint_wallet_tests peg_out_fail_refund
00:01:12         SLOW [> 60.000s] fedimint-wallet-tests::fedimint_wallet_tests peg_outs_must_wait_for_available_utxos
00:01:12         SLOW [> 60.000s] fedimint-wallet-tests::fedimint_wallet_tests peg_outs_support_rbf
00:01:12         SLOW [> 60.000s] fedimint-wallet-tests::fedimint_wallet_tests sanity_check_bitcoin_blocks
00:01:23         PASS [  71.741s] fedimint-wallet-tests::fedimint_wallet_tests peg_out_fail_refund
00:01:37         PASS [  85.270s] fedimint-wallet-tests::fedimint_wallet_tests peg_outs_must_wait_for_available_utxos
00:01:45         PASS [  93.520s] fedimint-wallet-tests::fedimint_wallet_tests on_chain_peg_in_and_peg_out_happy_case
00:01:49         PASS [  97.084s] fedimint-wallet-tests::fedimint_wallet_tests sanity_check_bitcoin_blocks
00:01:59         PASS [ 107.483s] fedimint-wallet-tests::fedimint_wallet_tests peg_outs_support_rbf
00:02:12         SLOW [>120.000s] fedimint-wallet-tests::fedimint_wallet_tests peg_ins_that_are_unconfirmed_are_rejected
00:03:12         SLOW [>180.000s] fedimint-wallet-tests::fedimint_wallet_tests peg_ins_that_are_unconfirmed_are_rejected
00:04:12         SLOW [>240.000s] fedimint-wallet-tests::fedimint_wallet_tests peg_ins_that_are_unconfirmed_are_rejected
00:05:12         SLOW [>300.000s] fedimint-wallet-tests::fedimint_wallet_tests peg_ins_that_are_unconfirmed_are_rejected
00:06:12         SLOW [>360.000s] fedimint-wallet-tests::fedimint_wallet_tests peg_ins_that_are_unconfirmed_are_rejected
00:06:42         PASS [ 390.440s] fedimint-wallet-tests::fedimint_wallet_tests peg_ins_that_are_unconfirmed_are_rejected
00:06:42 ------------
00:06:42      Summary [ 390.440s] 6 tests run: 6 passed (6 slow), 0 skipped
00:06:42 ### Testing against electrs - complete
00:06:42 fm success: rust-tests
00:06:42 Auto-killing external-daemons(PID: 39097) and waiting it to finish...
00:06:42 2023-09-24T05:43:10.591435Z  INFO task: signal received, starting graceful shutdown
00:06:42 2023-09-24T05:43:10.595011Z  INFO devimint: sending SIGTERM to lightningd and waiting for it to exit
00:06:42 2023-09-24T05:43:10.596308Z  INFO devimint: sending SIGKILL to lnd and waiting for it to exit
00:06:42 2023-09-24T05:43:10.599410Z  INFO devimint: sending SIGKILL to electrs and waiting for it to exit
00:06:42 2023-09-24T05:43:10.601029Z  INFO devimint: sending SIGKILL to esplora and waiting for it to exit
00:06:42 2023-09-24T05:43:10.602518Z  INFO devimint: sending SIGKILL to bitcoind and waiting for it to exit
## COMPLETE: backend_test_electrs
## START: backend_test_esplora
00:00:00 Setting up env variables in /tmp/nix-shell.mCrVBQ/nix-shell.bWG9jl/fm-4mjc
00:00:00     Finished dev [unoptimized + debuginfo] target(s) in 0.22s
00:00:00 ### Setting up tests
00:00:00 2023-09-24T05:36:33.607542Z  INFO devimint: Test setup in "/tmp/nix-shell.mCrVBQ/nix-shell.bWG9jl/fm-4mjc/cfg"
00:00:00 2023-09-24T05:36:33.608600Z  WARN devimint: Failed to create wallet ... retrying JSON-RPC error: transport error: Couldn't connect to host: Connection refused (os error 111)
00:00:03 2023-09-24T05:36:36.018320Z  INFO devimint: electrs started
00:00:03 2023-09-24T05:36:36.019347Z  INFO devimint: esplora started
00:00:06 2023-09-24T05:36:39.277426Z  INFO devimint: block sync done
00:00:06 2023-09-24T05:36:39.280595Z  INFO devimint: Sending funds from bitcoind amount=100000000 addr="bcrt1qwz42uv6asws34ush0sljzcmm3wfvrmj2vjmyv9"
00:00:06 2023-09-24T05:36:39.290997Z  INFO devimint: Mining bitcoin blocks block_num=10
00:00:06 2023-09-24T05:36:39.868135Z  INFO devimint: Mining bitcoin blocks block_num=10
00:00:08 2023-09-24T05:36:41.175413Z  WARN devimint::external: Empty chan info edge=ChannelEdge { channel_id: 123145302376448, chan_point: "80b6c3c255c67f93e9d37193ea4e1d167a1bceb20344c23705dd00dc18affdad:0", last_update: 1695533801, node1_pub: "02c02aa524919dfdcb827e6c76228fde59b6e9a9d81a59359473a84b1e326a1c47", node2_pub: "03bd3c96d5bdebb1ed9c816694ec8cb5f6c7bef64ebe95184e75faa16665819e37", capacity: 10000000, node1_policy: None, node2_policy: Some(RoutingPolicy { time_lock_delta: 80, min_htlc: 1000, fee_base_msat: 1000, fee_rate_milli_msat: 1, disabled: false, max_htlc_msat: 10000000000, last_update: 1695533801 }) }
00:00:09 2023-09-24T05:36:42.420375Z  WARN devimint::external: Empty chan info edge=ChannelEdge { channel_id: 123145302376448, chan_point: "80b6c3c255c67f93e9d37193ea4e1d167a1bceb20344c23705dd00dc18affdad:0", last_update: 1695533801, node1_pub: "02c02aa524919dfdcb827e6c76228fde59b6e9a9d81a59359473a84b1e326a1c47", node2_pub: "03bd3c96d5bdebb1ed9c816694ec8cb5f6c7bef64ebe95184e75faa16665819e37", capacity: 10000000, node1_policy: None, node2_policy: Some(RoutingPolicy { time_lock_delta: 80, min_htlc: 1000, fee_base_msat: 1000, fee_rate_milli_msat: 1, disabled: false, max_htlc_msat: 10000000000, last_update: 1695533801 }) }
00:00:11 2023-09-24T05:36:44.027725Z  INFO devimint: starting base daemons took 10.420050486s
00:00:11 ### Setting up tests - complete
00:00:11 ### Testing against esplora
00:00:12     Finished test [unoptimized + debuginfo] target(s) in 0.27s
00:00:12     Starting 6 tests across 52 binaries
00:01:12         SLOW [> 60.000s] fedimint-wallet-tests::fedimint_wallet_tests on_chain_peg_in_and_peg_out_happy_case
00:01:12         SLOW [> 60.000s] fedimint-wallet-tests::fedimint_wallet_tests peg_ins_that_are_unconfirmed_are_rejected
00:01:12         SLOW [> 60.000s] fedimint-wallet-tests::fedimint_wallet_tests peg_out_fail_refund
00:01:12         SLOW [> 60.000s] fedimint-wallet-tests::fedimint_wallet_tests peg_outs_must_wait_for_available_utxos
00:01:12         SLOW [> 60.000s] fedimint-wallet-tests::fedimint_wallet_tests peg_outs_support_rbf
00:01:12         SLOW [> 60.000s] fedimint-wallet-tests::fedimint_wallet_tests sanity_check_bitcoin_blocks
00:02:12         SLOW [>120.000s] fedimint-wallet-tests::fedimint_wallet_tests on_chain_peg_in_and_peg_out_happy_case
00:02:12         SLOW [>120.000s] fedimint-wallet-tests::fedimint_wallet_tests peg_ins_that_are_unconfirmed_are_rejected
00:02:12         SLOW [>120.000s] fedimint-wallet-tests::fedimint_wallet_tests peg_out_fail_refund
00:02:12         SLOW [>120.000s] fedimint-wallet-tests::fedimint_wallet_tests peg_outs_must_wait_for_available_utxos
00:02:12         SLOW [>120.000s] fedimint-wallet-tests::fedimint_wallet_tests peg_outs_support_rbf
00:02:12         SLOW [>120.000s] fedimint-wallet-tests::fedimint_wallet_tests sanity_check_bitcoin_blocks
00:03:12         SLOW [>180.000s] fedimint-wallet-tests::fedimint_wallet_tests on_chain_peg_in_and_peg_out_happy_case
00:03:12         SLOW [>180.000s] fedimint-wallet-tests::fedimint_wallet_tests peg_ins_that_are_unconfirmed_are_rejected
00:03:12         SLOW [>180.000s] fedimint-wallet-tests::fedimint_wallet_tests peg_out_fail_refund
00:03:12         SLOW [>180.000s] fedimint-wallet-tests::fedimint_wallet_tests peg_outs_must_wait_for_available_utxos
00:03:12         SLOW [>180.000s] fedimint-wallet-tests::fedimint_wallet_tests peg_outs_support_rbf
00:03:12         SLOW [>180.000s] fedimint-wallet-tests::fedimint_wallet_tests sanity_check_bitcoin_blocks
00:03:15         PASS [ 183.548s] fedimint-wallet-tests::fedimint_wallet_tests peg_out_fail_refund
00:03:38         PASS [ 206.414s] fedimint-wallet-tests::fedimint_wallet_tests peg_outs_support_rbf
00:04:12         SLOW [>240.000s] fedimint-wallet-tests::fedimint_wallet_tests on_chain_peg_in_and_peg_out_happy_case
00:04:12         SLOW [>240.000s] fedimint-wallet-tests::fedimint_wallet_tests peg_ins_that_are_unconfirmed_are_rejected
00:04:12         SLOW [>240.000s] fedimint-wallet-tests::fedimint_wallet_tests peg_outs_must_wait_for_available_utxos
00:04:12         SLOW [>240.000s] fedimint-wallet-tests::fedimint_wallet_tests sanity_check_bitcoin_blocks
00:04:13         PASS [ 241.599s] fedimint-wallet-tests::fedimint_wallet_tests on_chain_peg_in_and_peg_out_happy_case
00:04:23         PASS [ 251.701s] fedimint-wallet-tests::fedimint_wallet_tests sanity_check_bitcoin_blocks
00:05:00         PASS [ 288.668s] fedimint-wallet-tests::fedimint_wallet_tests peg_outs_must_wait_for_available_utxos
00:05:12         SLOW [>300.000s] fedimint-wallet-tests::fedimint_wallet_tests peg_ins_that_are_unconfirmed_are_rejected
00:06:12         SLOW [>360.000s] fedimint-wallet-tests::fedimint_wallet_tests peg_ins_that_are_unconfirmed_are_rejected
00:06:44         PASS [ 391.861s] fedimint-wallet-tests::fedimint_wallet_tests peg_ins_that_are_unconfirmed_are_rejected
00:06:44 ------------
00:06:44      Summary [ 391.861s] 6 tests run: 6 passed (6 slow), 0 skipped
00:06:44 ### Testing against esplora - complete
00:06:44 fm success: rust-tests
00:06:44 Auto-killing external-daemons(PID: 39743) and waiting it to finish...
00:06:44 2023-09-24T05:43:17.053107Z  INFO task: signal received, starting graceful shutdown
00:06:44 2023-09-24T05:43:17.056356Z  INFO devimint: sending SIGTERM to lightningd and waiting for it to exit
00:06:44 2023-09-24T05:43:17.057198Z  INFO devimint: sending SIGKILL to lnd and waiting for it to exit
00:06:44 2023-09-24T05:43:17.060156Z  INFO devimint: sending SIGKILL to electrs and waiting for it to exit
00:06:44 2023-09-24T05:43:17.061044Z  INFO devimint: sending SIGKILL to esplora and waiting for it to exit
00:06:44 2023-09-24T05:43:17.062441Z  INFO devimint: sending SIGKILL to bitcoind and waiting for it to exit
## COMPLETE: backend_test_esplora
## START: backend_test_bitcoind
00:00:00 Setting up env variables in /tmp/nix-shell.mCrVBQ/nix-shell.bWG9jl/fm-SSc1
00:00:00     Finished dev [unoptimized + debuginfo] target(s) in 0.26s
00:00:00 ### Setting up tests
00:00:00 2023-09-24T05:36:23.609270Z  INFO devimint: Test setup in "/tmp/nix-shell.mCrVBQ/nix-shell.bWG9jl/fm-SSc1/cfg"
00:00:00 2023-09-24T05:36:23.610429Z  WARN devimint: Failed to create wallet ... retrying JSON-RPC error: transport error: Couldn't connect to host: Connection refused (os error 111)
00:00:02 2023-09-24T05:36:25.949863Z  INFO devimint: electrs started
00:00:02 2023-09-24T05:36:25.950826Z  INFO devimint: esplora started
00:00:06 2023-09-24T05:36:29.215584Z  INFO devimint: block sync done
00:00:06 2023-09-24T05:36:29.218891Z  INFO devimint: Sending funds from bitcoind amount=100000000 addr="bcrt1q9znd0fqw6vatgyzwr4jnlrepyj5lshffkqu2fs"
00:00:06 2023-09-24T05:36:29.230590Z  INFO devimint: Mining bitcoin blocks block_num=10
00:00:06 2023-09-24T05:36:29.816803Z  INFO devimint: Mining bitcoin blocks block_num=10
00:00:08 2023-09-24T05:36:31.112724Z  INFO devimint: starting base daemons took 7.503240635s
00:00:09 ### Setting up tests - complete
00:00:09 ### Testing against bitcoind
00:00:09     Finished test [unoptimized + debuginfo] target(s) in 0.25s
00:00:09     Starting 5 tests across 52 binaries
00:00:09         PASS [   0.055s] fedimint-dummy-tests::fedimint_dummy_tests unbalanced_transactions_get_rejected
00:00:09         PASS [   0.059s] fedimint-dummy-tests::fedimint_dummy_tests client_ignores_unknown_module
00:00:11         PASS [   2.507s] fedimint-dummy-tests::fedimint_dummy_tests can_threshold_sign_message
00:00:13         PASS [   3.866s] fedimint-dummy-tests::fedimint_dummy_tests can_print_and_send_money
00:00:51         PASS [  42.054s] fedimint-dummy-tests::fedimint_dummy_tests federation_should_abort_if_balance_sheet_is_negative
00:00:51 ------------
00:00:51      Summary [  42.059s] 5 tests run: 5 passed, 0 skipped
00:00:51     Finished test [unoptimized + debuginfo] target(s) in 0.49s
00:00:52     Starting 1 test across 52 binaries
00:01:06         PASS [  14.903s] fedimint-mint-tests::fedimint_mint_tests sends_ecash_out_of_band
00:01:06 ------------
00:01:06      Summary [  14.903s] 1 test run: 1 passed, 0 skipped
00:01:07     Finished test [unoptimized + debuginfo] target(s) in 0.36s
00:01:07     Starting 6 tests across 52 binaries
00:02:07         SLOW [> 60.000s] fedimint-wallet-tests::fedimint_wallet_tests on_chain_peg_in_and_peg_out_happy_case
00:02:07         SLOW [> 60.000s] fedimint-wallet-tests::fedimint_wallet_tests peg_ins_that_are_unconfirmed_are_rejected
00:02:07         SLOW [> 60.000s] fedimint-wallet-tests::fedimint_wallet_tests peg_out_fail_refund
00:02:07         SLOW [> 60.000s] fedimint-wallet-tests::fedimint_wallet_tests peg_outs_must_wait_for_available_utxos
00:02:07         SLOW [> 60.000s] fedimint-wallet-tests::fedimint_wallet_tests peg_outs_support_rbf
00:02:07         SLOW [> 60.000s] fedimint-wallet-tests::fedimint_wallet_tests sanity_check_bitcoin_blocks
00:03:07         SLOW [>120.000s] fedimint-wallet-tests::fedimint_wallet_tests on_chain_peg_in_and_peg_out_happy_case
00:03:07         SLOW [>120.000s] fedimint-wallet-tests::fedimint_wallet_tests peg_ins_that_are_unconfirmed_are_rejected
00:03:07         SLOW [>120.000s] fedimint-wallet-tests::fedimint_wallet_tests peg_out_fail_refund
00:03:07         SLOW [>120.000s] fedimint-wallet-tests::fedimint_wallet_tests peg_outs_must_wait_for_available_utxos
00:03:07         SLOW [>120.000s] fedimint-wallet-tests::fedimint_wallet_tests peg_outs_support_rbf
00:03:07         SLOW [>120.000s] fedimint-wallet-tests::fedimint_wallet_tests sanity_check_bitcoin_blocks
00:04:07         SLOW [>180.000s] fedimint-wallet-tests::fedimint_wallet_tests on_chain_peg_in_and_peg_out_happy_case
00:04:07         SLOW [>180.000s] fedimint-wallet-tests::fedimint_wallet_tests peg_ins_that_are_unconfirmed_are_rejected
00:04:07         SLOW [>180.000s] fedimint-wallet-tests::fedimint_wallet_tests peg_out_fail_refund
00:04:07         SLOW [>180.000s] fedimint-wallet-tests::fedimint_wallet_tests peg_outs_must_wait_for_available_utxos
00:04:07         SLOW [>180.000s] fedimint-wallet-tests::fedimint_wallet_tests peg_outs_support_rbf
00:04:07         SLOW [>180.000s] fedimint-wallet-tests::fedimint_wallet_tests sanity_check_bitcoin_blocks
00:05:07         SLOW [>240.000s] fedimint-wallet-tests::fedimint_wallet_tests on_chain_peg_in_and_peg_out_happy_case
00:05:07         SLOW [>240.000s] fedimint-wallet-tests::fedimint_wallet_tests peg_ins_that_are_unconfirmed_are_rejected
00:05:07         SLOW [>240.000s] fedimint-wallet-tests::fedimint_wallet_tests peg_out_fail_refund
00:05:07         SLOW [>240.000s] fedimint-wallet-tests::fedimint_wallet_tests peg_outs_must_wait_for_available_utxos
00:05:07         SLOW [>240.000s] fedimint-wallet-tests::fedimint_wallet_tests peg_outs_support_rbf
00:05:07         SLOW [>240.000s] fedimint-wallet-tests::fedimint_wallet_tests sanity_check_bitcoin_blocks
00:06:07         SLOW [>300.000s] fedimint-wallet-tests::fedimint_wallet_tests on_chain_peg_in_and_peg_out_happy_case
00:06:07         SLOW [>300.000s] fedimint-wallet-tests::fedimint_wallet_tests peg_ins_that_are_unconfirmed_are_rejected
00:06:07         SLOW [>300.000s] fedimint-wallet-tests::fedimint_wallet_tests peg_out_fail_refund
00:06:07         SLOW [>300.000s] fedimint-wallet-tests::fedimint_wallet_tests peg_outs_must_wait_for_available_utxos
00:06:07         SLOW [>300.000s] fedimint-wallet-tests::fedimint_wallet_tests peg_outs_support_rbf
00:06:07         SLOW [>300.000s] fedimint-wallet-tests::fedimint_wallet_tests sanity_check_bitcoin_blocks
00:06:17         PASS [ 309.901s] fedimint-wallet-tests::fedimint_wallet_tests peg_out_fail_refund
00:06:18         PASS [ 311.045s] fedimint-wallet-tests::fedimint_wallet_tests sanity_check_bitcoin_blocks
00:06:32         PASS [ 324.717s] fedimint-wallet-tests::fedimint_wallet_tests peg_outs_support_rbf
00:06:41         PASS [ 333.841s] fedimint-wallet-tests::fedimint_wallet_tests peg_outs_must_wait_for_available_utxos
00:06:47         PASS [ 339.878s] fedimint-wallet-tests::fedimint_wallet_tests on_chain_peg_in_and_peg_out_happy_case
00:06:54         PASS [ 346.729s] fedimint-wallet-tests::fedimint_wallet_tests peg_ins_that_are_unconfirmed_are_rejected
00:06:54 ------------
00:06:54      Summary [ 346.730s] 6 tests run: 6 passed (6 slow), 0 skipped
00:06:54     Finished test [unoptimized + debuginfo] target(s) in 0.23s
00:06:54     Starting 4 tests across 52 binaries
00:06:57         PASS [   2.753s] fedimint-ln-tests::fedimint_ln_tests can_switch_active_gateway
00:07:00         PASS [   6.190s] fedimint-ln-tests::fedimint_ln_tests rejects_wrong_network_invoice
00:07:06         PASS [  11.955s] fedimint-ln-tests::fedimint_ln_tests makes_internal_payments_within_federation
00:07:27         PASS [  33.011s] fedimint-ln-tests::fedimint_ln_tests test_can_attach_extra_meta_to_receive_operation
00:07:27 ------------
00:07:27      Summary [  33.012s] 4 tests run: 4 passed, 0 skipped
00:07:27     Finished test [unoptimized + debuginfo] target(s) in 0.23s
00:07:27     Starting 17 tests across 52 binaries
00:07:27         PASS [   0.006s] ln-gateway utils::tests::retry_fail_with_three_attempts
00:07:27         PASS [   0.003s] ln-gateway utils::tests::retry_succeed_with_one_attempt
00:08:27         SLOW [> 60.000s] ln-gateway::gatewayd-integration-tests test_gateway_can_pay_ldk_node
00:08:41         PASS [  73.300s] ln-gateway::gatewayd-integration-tests test_gateway_can_pay_ldk_node
00:09:13         PASS [  32.443s] ln-gateway::gatewayd-integration-tests test_gateway_cannot_claim_invalid_preimage
00:09:43         PASS [  29.670s] ln-gateway::gatewayd-integration-tests test_gateway_cannot_pay_expired_invoice
00:10:09         PASS [  26.481s] ln-gateway::gatewayd-integration-tests test_gateway_client_intercept_htlc_invalid_offer
00:10:20         PASS [  11.256s] ln-gateway::gatewayd-integration-tests test_gateway_client_intercept_htlc_no_funds
00:10:40         PASS [  19.799s] ln-gateway::gatewayd-integration-tests test_gateway_client_intercept_offer_does_not_exist
00:11:04         PASS [  23.770s] ln-gateway::gatewayd-integration-tests test_gateway_client_intercept_valid_htlc
00:11:30         PASS [  25.663s] ln-gateway::gatewayd-integration-tests test_gateway_client_pay_unpayable_invoice
00:12:18         PASS [  48.817s] ln-gateway::gatewayd-integration-tests test_gateway_client_pay_valid_invoice
00:12:22         PASS [   3.630s] ln-gateway::gatewayd-integration-tests test_gateway_configuration
00:12:36         PASS [  14.255s] ln-gateway::gatewayd-integration-tests test_gateway_filters_route_hints_by_inbound
00:12:39         PASS [   2.631s] ln-gateway::gatewayd-integration-tests test_gateway_register_with_federation
00:12:49         PASS [   9.987s] ln-gateway::gatewayd-integration-tests test_gateway_shows_balance_for_any_connected_federation
00:12:52         PASS [   2.792s] ln-gateway::gatewayd-integration-tests test_gateway_shows_info_about_all_connected_federations
00:12:55         PASS [   2.805s] ln-gateway::gatewayd-integration-tests test_gateway_supports_connecting_multiple_federations
00:12:55 ------------
00:12:55      Summary [ 327.306s] 17 tests run: 17 passed (1 slow), 0 skipped
00:12:55 ### Testing against bitcoind - complete
00:12:55 fm success: rust-tests
00:12:55 Auto-killing external-daemons(PID: 38680) and waiting it to finish...
00:12:55 2023-09-24T05:49:18.061741Z  INFO task: signal received, starting graceful shutdown
00:12:55 2023-09-24T05:49:18.065812Z  INFO devimint: sending SIGTERM to lightningd and waiting for it to exit
00:12:55 2023-09-24T05:49:18.066742Z  INFO devimint: sending SIGKILL to lnd and waiting for it to exit
00:12:55 2023-09-24T05:49:18.071273Z  INFO devimint: sending SIGKILL to electrs and waiting for it to exit
00:12:55 2023-09-24T05:49:18.072335Z  INFO devimint: sending SIGKILL to esplora and waiting for it to exit
00:12:55 2023-09-24T05:49:18.073863Z  INFO devimint: sending SIGKILL to bitcoind and waiting for it to exit
## COMPLETE: backend_test_bitcoind
All tests successful
test run 2
